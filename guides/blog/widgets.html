<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Widgets â€” Joosy Guides</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/skeleton.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/credits.css">
    <link rel="stylesheet" href="http://yandex.st/highlightjs/6.2/styles/default.min.css">
    <script src="http://cachedcommons.org/cache/modernizr/1.5.0/javascripts/modernizr-min.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/prefixfree.min.js"></script>
    <script src="/js/jquery-1.7.2.min.js"></script>
	<script src="/js/jquery.browser.js"></script>
    <script>
      function toggle(element) {
        element.style.display = (element.style.display == 'none') ? 'block' : 'none'
      }
    </script>
  </head>
  <body>
     <div class="topbar">
       <div class="topbar_wrap">
         <table cellpadding="0" cellspacing="0">
		   <tbody>
		     <tr>		    
			   <td><a href="http://joosy.ws">Joosy (1.1.0)</a></td>
			   <td class="disabled"><a href="#" >Who's using</a></td>
  			   <td><a href="http://sample.joosy.ws">Annotated sample</a></td>
			   <td class="active"><a href="http://guides.joosy.ws">Guides</a></td>
			   <td class="disabled"><a href="#" >Screencasts</a></td>
			   <td><a href="http://api.joosy.ws">API</a></td>
			   <td><a href="http://github.com/joosy/joosy">Code</a></td>
			   <td><a href="http://github.com/joosy/joosy/issues">Bugs/Patches</a></td>
			   <td  class="disabled"><a href="#">Community</a></td>
			   <td class="twitter">
  			     <a href="http://twitter.com/joosy_web">Twitter</a>
			     <img src="/img/twit_sign_orange.png" alt="">
			   </td>
		     </tr>
		   </tbody>
	     </table>
       </div>
     </div>
     <header>
      <div class="container">
        <div class="six columns">
          <h1><a href="/">Joosy Guides</a></h1>
        </div>
        <div class="ten columns">
          <ul class="nav">
            <li><a href="/">Home</a></li>
            <li>
              <a href="#" onclick="toggle(document.getElementById('guides'))" class="index">Guides Index &#9660;</a>
              <div style="display: none;" class="clearfix" id="guides">
                <hr />
                <dl class="L">
                  <dt>Joosy basics</dt>
                  <dd><a href="/guides/basics/getting-started.html">Getting Started</a></dd>
                  <dd><a href="/guides/basics/joosy-vs-x.html">Joosy vs X</a></dd>
                  <dt>Creating a blog on Joosy</dt>
                  <dd><a href="/guides/blog/rails-preparations.html">Rails preparations</a></dd>
                  <dd><a href="/guides/blog/resources.html">Resources</a></dd>
                  <dd><a href="/guides/blog/layouts-pages-and-routing.html">Layouts, Pages and Routing</a></dd>
                  <dd><a href="/guides/blog/elements-events-and-filters.html">Elements, Events and Filters</a></dd>
                  <dd><a href="/guides/blog/dynamic-rendering.html">Dynamic rendering</a></dd>
                  <dd><a href="/guides/blog/widgets.html">Widgets</a></dd>
                  <dd><a href="/guides/blog/helpers.html">Helpers</a></dd>
                  <dd><a href="/guides/blog/forms.html">Forms</a></dd>
                  <dd><a href="/guides/blog/preloaders.html">Preloaders</a></dd>
                  <dd><a href="/guides/blog/load-unload-and-in-progress-animations.html">Load, unload, animations</a></dd>
                </dl>
                <dl class="R">
                  <dt>Advanced guides</dt>
                  <dd><a href="/guides/advanced/search-engine-indexing.html">Search engine indexing</a></dd>
                  <dd><a href="/guides/advanded/authentication.html">Authentication</a></dd>
                  <dd><a href="/guides/advanced/permissions.html">Permissions and ACL</a></dd>
                  <dd><a href="/guides/advanced/template-engine.html">Template engines</a></dd>
                </dl>
              </div>
            </li> 
            <li><a href="/contribute.html">Contribute</a></li>
            <li><a href="/credits.html">Credits</a></li>
          </ul>
        </div>
      </div>
    </header>
    <div class="container">
      <section class="row">
        <div class="sixteen columns">
          <article class="hentry">
  <div class="entry-header">
    <h2>Widgets</h2>
  </div>
  <div class="entry-content">
    <p>According to the previous chapter goals we are going to move inline editor functionality to the Widget and include it into index page. Generate Widget:</p>

<script src="http://gist.github.com/2828061.js?file=Generate.sh">// Gist is loading...</script>

<h2>Creating widget</h2>

<p>Just like pages and layouts, widgets can have elements, events, filters and templates. The key difference is the first container you meet that can be created by you. That&#39;s why it has constructor. Our current goal is to move all the functionality we created for the Show page to the widget as-is.</p>

<script src="http://gist.github.com/2828061.js?file=Widget.coffee">// Gist is loading...</script>

<p>Remember to remove all this stuff from the Show page! It&#39;s not needed anymore!</p>

<p>The next step is to move all the required HAML into widget&#39;s template. And don&#39;t forget the dynamic partial that should be moved to <code>templates/widgets</code> directory either.</p>

<script src="http://gist.github.com/2828061.js?file=Templates.haml">// Gist is loading...</script>

<h2>Including widget</h2>

<p>Widget is quite a common entity. Widget you create can wrap around existing DOM, use own templates, interact with page/layout or be completely encapsulated. To fulfill such needs Joosy introduces two methods to require widget.</p>

<p>The first one goes the direct inclusion from within a template. This is a very comfortable way of inclusion if your widget has its own template and is encapsulated. Our new widget fits perfectly.</p>

<script src="http://gist.github.com/2828061.js?file=Widget Template.haml">// Gist is loading...</script>

<p>Look at the line one. The first argument is a container tag for the widget to be put at. Choose something that will not break your layout. And the second parameter is a widget you are going to bind to container tag. It can be a lambda (like in example) or just a widget class. In the latter case it will be created without arguments to constructor.</p>

<p>And actually this is it. Nothing more is required to do. If only expand our widget usage to the Posts.Index page. So was the plan, wasn&#39;t it?</p>

<script src="http://gist.github.com/2828061.js?file=Widget Index Template.haml">// Gist is loading...</script>

<div class="warning">
  <p>
    More info about widgets inclusion and manipulation is not required to complete our blog. Skip to the <a href="/guides/blog/helpers.html">next chapter</a> if you want to get back to that later.
  </p>
</div>

<hr class="additional" />

<h2>Alternative widget registration</h2>

<p>If your widgets are about to control the existing DOM structures (please ensure you don&#39;t break encapsulation) or you are going to interact between widget and it&#39;s container, you have an option to directly bind the widget from a page. This looks similar to the elements and events bindings. You just define the <code>widgets</code> hash:</p>

<script src="http://gist.github.com/2828061.js?file=Widgets Hash.coffee">// Gist is loading...</script>

<p>To maintain direct bridge between the container and the widget you can assign creating instance of widet instance variable. That&#39;s exactly what we do at the third example. But <strong>beware</strong>! If the selector matches several DOM elements, each of them will be passed to a separate widget. And therefore with this lambda <code>@testWidget</code> will always contain the last loaded widget.</p>

<h2>Manual registration and destruction</h2>

<p>You can either register and unregister widgets manually. Page and Layout define two methods to help you with this. They are: <code>@registerWidget(container, widget)</code> and <code>@unregisterWidget(widget)</code>. </p>

<p>The first one takes the reference to the DOM node (container) and the widget. The widget can be pased in the same manner, as a Class or as a lambda. <code>registerWidget</code> will return you the widget instance. It will be unloaded in process of page/layout destruction.</p>

<p>In cases when you want to control the lifetime of this widget manually, use <code>unregisterWidget</code> that accepts the instance of widget to shutdown. Note that still widgets never survive destruction of page/layout they are contained by.</p>

<p>Next Chapter - <a href="/guides/blog/helpers.html">helpers</a>.</p>

  </div>
</article>

        </div>
      </section>
    </div>
    <div id="footer">
        <div class="wrapper">
            <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-Share Alike 3.0</a> License</p>
            <p>Sources of this guide are available <a href="https://github.com/joosy/guides">on Github</a>.</p>
        </div>
    </div>
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '4fb67f54f5a1f56550000016');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>
