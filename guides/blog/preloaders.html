<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Preloaders â€” Joosy Guides</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/skeleton.css">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/credits.css">
    <link rel="stylesheet" href="http://yandex.st/highlightjs/6.2/styles/default.min.css">
    <script src="http://cachedcommons.org/cache/modernizr/1.5.0/javascripts/modernizr-min.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/prefixfree.min.js"></script>
    <script src="/js/jquery-1.7.2.min.js"></script>
	<script src="/js/jquery.browser.js"></script>
    <script>
      function toggle(element) {
        element.style.display = (element.style.display == 'none') ? 'block' : 'none'
      }
    </script>
  </head>
  <body>
     <div class="topbar">
       <div class="topbar_wrap">
         <table cellpadding="0" cellspacing="0">
		   <tbody>
		     <tr>		    
			   <td><a href="http://joosy.ws">Joosy (1.1.0)</a></td>
			   <td class="disabled"><a href="#" >Who's using</a></td>
  			   <td><a href="http://sample.joosy.ws">Annotated sample</a></td>
			   <td class="active"><a href="http://guides.joosy.ws">Guides</a></td>
			   <td class="disabled"><a href="#" >Screencasts</a></td>
			   <td><a href="http://api.joosy.ws">API</a></td>
			   <td><a href="http://github.com/joosy/joosy">Code</a></td>
			   <td><a href="http://github.com/joosy/joosy/issues">Bugs/Patches</a></td>
			   <td  class="disabled"><a href="#">Community</a></td>
			   <td class="twitter">
  			     <a href="http://twitter.com/joosy_web">Twitter</a>
			     <img src="/img/twit_sign_orange.png" alt="">
			   </td>
		     </tr>
		   </tbody>
	     </table>
       </div>
     </div>
     <header>
      <div class="container">
        <div class="six columns">
          <h1><a href="/">Joosy Guides</a></h1>
        </div>
        <div class="ten columns">
          <ul class="nav">
            <li><a href="/">Home</a></li>
            <li>
              <a href="#" onclick="toggle(document.getElementById('guides'))" class="index">Guides Index &#9660;</a>
              <div style="display: none;" class="clearfix" id="guides">
                <hr />
                <dl class="L">
                  <dt>Joosy basics</dt>
                  <dd><a href="/guides/basics/getting-started.html">Getting Started</a></dd>
                  <dd><a href="/guides/basics/joosy-vs-x.html">Joosy vs X</a></dd>
                  <dt>Creating a blog on Joosy</dt>
                  <dd><a href="/guides/blog/rails-preparations.html">Rails preparations</a></dd>
                  <dd><a href="/guides/blog/resources.html">Resources</a></dd>
                  <dd><a href="/guides/blog/layouts-pages-and-routing.html">Layouts, Pages and Routing</a></dd>
                  <dd><a href="/guides/blog/elements-events-and-filters.html">Elements, Events and Filters</a></dd>
                  <dd><a href="/guides/blog/dynamic-rendering.html">Dynamic rendering</a></dd>
                  <dd><a href="/guides/blog/widgets.html">Widgets</a></dd>
                  <dd><a href="/guides/blog/helpers.html">Helpers</a></dd>
                  <dd><a href="/guides/blog/forms.html">Forms</a></dd>
                  <dd><a href="/guides/blog/preloaders.html">Preloaders</a></dd>
                  <dd><a href="/guides/blog/load-unload-and-in-progress-animations.html">Load, unload, animations</a></dd>
                </dl>
                <dl class="R">
                  <dt>Advanced guides</dt>
                  <dd><a href="/guides/advanced/search-engine-indexing.html">Search engine indexing</a></dd>
                  <dd><a href="/guides/advanded/authentication.html">Authentication</a></dd>
                  <dd><a href="/guides/advanced/permissions.html">Permissions and ACL</a></dd>
                  <dd><a href="/guides/advanced/template-engine.html">Template engines</a></dd>
                </dl>
              </div>
            </li> 
            <li><a href="/contribute.html">Contribute</a></li>
            <li><a href="/credits.html">Credits</a></li>
          </ul>
        </div>
      </div>
    </header>
    <div class="container">
      <section class="row">
        <div class="sixteen columns">
          <article class="hentry">
  <div class="entry-header">
    <h2>Preloaders</h2>
  </div>
  <div class="entry-content">
    <p>RICH applications that we create with Joosy can weight a lot. While 200KB look not that much for modern internet it still can be a pain for mobile tethering. And it always is better to allow client see load progress. Joosy bundles preloaders that implement several strategies.</p>

<h2>Caching (default one)</h2>

<p>This preloader will use localStorage of client browser to manually load and save all the assets. This will guarantee stable cache and proper reloading. Beware though: client browser is supposed to support the localStorage feature. Shims are not doing very well here since for the elder browsers the amount of available storage is often not enough. Remember that 200k is your gziped value while it saves the unarchived JS inside localStorage.</p>

<p>The practice shows, however, that even extremely large application always fit under 1Mb of minified JS. Which is far away from basicly available 5Mb limit.</p>

<h2>Inline</h2>

<p>Unlike caching preloader this one will relay on HTTP caching. Each page load will try to load all the assets over and over. It&#39;s a browser&#39;s choise if it will be loaded from the server or not. This kind of preloader has an unpleasant drawback. It can&#39;t tell you about the progress. It only supports <code>loaded</code> hook.</p>

<h2>Preloaders API</h2>

<p>All the preloaders share the same API (but not all of them use all of available hooks). The bootstrap code that uses the preloader of your blog is situated at <code>blog_preloader.js.coffee.erb</code>.</p>

<script src="http://gist.github.com/2830293.js?file=Helper.coffee">// Gist is loading...</script>

<p>Using this line you can controll which strategy will be used. Force option is something you can use to test your preloaders within development environment. By default preloaders will only be activated at production. Set it to true and reload your page.</p>

<div class="info">
  <p>
    Note that within development environment (with `force: true`) caching preloader will never reset its cache. To force this you can call `localStorage.clear()` from your browser console.
  </p>
</div>

<p>The layout for your loading progress counter is situated in <code>app/views/blog.html.erb</code>. This is the place to add some CSS for a better look.</p>

<p>But let&#39;s get back to the available options of the Preloader.</p>

<script src="http://gist.github.com/2830293.js?file=Preloader.coffee">// Gist is loading...</script>

<p>This is the typical preloader usage. It contains all the available options you can use. Some of preloaders (like Inline) may ignore <code>progress</code> callback but common logic is still the same.</p>

<p>Please note that we do not use jQuery at this stage cause it&#39;s not yet available. You&#39;ll get it when the preloading is done. So it&#39;s safe to start using it inside your <code>bootstrap</code> callback but not before! Same goes to every other library you depend on.</p>

<p>Take a closer look at what happens at the <code>start</code> callback. Before it was called our progress bar stays invisible. If you use the <code>Caching</code> strategy this helps to avoid progress bar blinking. Loading assets from localStorage takes some microseconds and for that time it will hang around. <code>start</code> callback will only be called if preloader is loading something from the server.</p>

<h2>Bootstrap</h2>

<p>And the last thing we have to discuss here does not directly touches the preloaders. It&#39;s about a Joosy application boostrap. Let&#39;s look through the actual <code>boostrap</code> callback</p>

<script src="http://gist.github.com/2830293.js?file=Bootstrap.coffee">// Gist is loading...</script>

<p>Application bootstrap accepts some options that you may find useful. Environment option has no direct use at this moment but the debug option does. As soon as you turn it on Joosy will start spamming your console with a lot of info that happens inside classes you use. Just give it a try. Sometimes it can save you an hour of debugging.</p>

<p>Our blog is ready and prepared to load properly. This already is a finished product but there&#39;s still one interesting feature Joosy has to offer. Pass on to the <a href="/guides/blog/load-unload-and-in-progress-animations.html">final chapter</a> to learn how to controll page switch animation.</p>

  </div>
</article>

        </div>
      </section>
    </div>
    <div id="footer">
        <div class="wrapper">
            <p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-Share Alike 3.0</a> License</p>
            <p>Sources of this guide are available <a href="https://github.com/joosy/guides">on Github</a>.</p>
        </div>
    </div>
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '4fb67f54f5a1f56550000016');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>
