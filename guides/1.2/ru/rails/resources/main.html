<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Ресурсы: Основные возможности — Joosy Guides</title>
    <meta charset='utf-8'>
    <link href='http://joosy.ws/application.css' rel='stylesheet'>
    <link href='//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="/assets/application-a08ca23316077c59bf0b1e4ef0c2b346.css">
    <script src='http://codeorigin.jquery.com/jquery-1.10.2.min.js' type='text/javascript'></script>
    <script src='//netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js' type='text/javascript'></script>
  </head>
  <body>
    <nav class='navbar navbar-inverse'>
      <div class='container'>
        <div class='collapse navbar-collapse'>
          <ul class='nav navbar-nav'>
            <li>
              <a href='http://joosy.ws'>
                Joosy
              </a>
            </li>
            <li class='disabled'>
              <a href='javascript:void(0)'>
                Download
              </a>
            </li>
            <li class='active'>
              <a href='http://guides.joosy.ws'>
                Guides
              </a>
            </li>
            <li>
              <a href='http://api.joosy.ws'>
                API
              </a>
            </li>
            <li>
              <a href='http://sample.joosy.ws'>
                Annotated sample
              </a>
            </li>
            <li class='disabled'>
              <a href='javascript:void(0)'>
                Screencasts
              </a>
            </li>
            <li>
              <a href='http://github.com/joosy/joosy/issues'>
                Bugs
              </a>
            </li>
            <li class='disabled'>
              <a href='javascript:void(0)'>
                Community
              </a>
            </li>
            <li class='twitter'>
              <a href="https://twitter.com/joosy_web" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Twitter</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class='content'>
  <header>
    <div class='container'>
      <img alt='Joosy framework' class='pull-left logo' src='http://joosy.ws/joosy.png'>
      <p class='pull-left'>
        Guides for version 1.2
        <a href='/'>
          Another version or language?
        </a>
      </p>
      <div class='menu pull-right'>
        <ul class='nav nav-pills'>
          <li class=''>
            <a href='/guides/1.2/ru'>
              <i class='icon-archive'></i>
              Index
            </a>
          </li>
          <li class='active'>
            <div id='guides'>
              
              <dl class='pull-left'>
  <dt>Joosy и Rails</dt>
  <dd>
    <ul>
      <li>
        <a href='/guides/1.2/ru/rails/init.html'>Установка и генераторы</a>
      </li>
    </ul>
  </dd>
  <dt class='inner'>Ресурсы Joosy</dt>
  <dd>
    <ul>
      <li>
        <a href='/guides/1.2/ru/rails/resources/preparations.html'>Подготовка Backend</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/resources/main.html'>Основные возможности</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/resources/autogeneration.html'>Авто-генерация</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/resources/filters-and-associations.html'>Фильтры и ассоциации</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/resources/pagination.html'>Разбиение на страницы</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/resources/cacher.html'>Cacher</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/resources/identity-map.html'>Identity Map</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/resources/alternate-accessors.html'>Альтернативный интерфейс акцессоров</a>
      </li>
    </ul>
  </dd>
  <dt class='inner'>Рендеринг</dt>
  <dd>
    <ul>
      <li>
        <a href='/guides/1.2/ru/rails/render/pages-layouts.html'>Страницы и лейауты</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/templates.html'>Шаблоны</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/routing.html'>Роутинг</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/elements-events.html'>Элементы и события</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/forms.html'>Формы</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/filters.html'>Фильтры</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/dynamic-rendering.html'>Динамический рендеринг</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/helpers.html'>Хэлперы</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/widgets-and-modules.html'>Виджеты и модули</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/render/animations.html'>Анимация</a>
      </li>
    </ul>
  </dd>
  <dt class='inner'>Дополнительные возможности</dt>
  <dd>
    <ul>
      <li>
        <a href='/guides/1.2/ru/rails/advanced/config.html'>Конфигурация Joosy</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/advanced/events.html'>События Joosy</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/rails/advanced/preloading.html'>Предзагрузка JS-файлов</a>
      </li>
    </ul>
  </dd>
</dl>
<dl class='pull-right'>
  <dt>Основы Joosy</dt>
  <dd>
    <ul>
      <li>
        <a href='/guides/1.2/ru/basics/understanding-joosy.html'>Как устроен Joosy</a>
      </li>
      <li>
        <a href='/guides/1.2/ru/basics/why-joosy.html'>Почему Joosy</a>
      </li>
    </ul>
  </dd>
  <dt class='inner'>Joosy и Node.js</dt>
  <dd>
    <ul>
      <li>
        <a href='/guides/1.2/ru/nodejs/init.html'>Генерация приложения</a>
      </li>
    </ul>
  </dd>
</dl>

            </div>
            <a class='dropdown-toggle' data-target='#guides' data-toggle='dropdown' href='#guides'>
              <i class='icon-long-arrow-down'></i>
              Guides
            </a>
          </li>
        </ul>
      </div>
    </div>
  </header>
  <section class='main'>
    <article class='entry'>
      <div class='entry-header'>
        <h2></h2>
      </div>
      <div class='entry-content l-ru v-1-2'>
        <h2>Ресурсы: Основные возможности</h2>

<p>Создадим joosy-класс для модели Post:</p>

<h5>app/assets/javascripts/resources/post.coffee</h5>

<div class="highlight"><pre><code class="ruby"><span class="lineno">1</span>   <span class="k">class</span> <span class="vi">@Post</span> <span class="n">extends</span> <span class="no">Joosy</span><span class="o">.</span><span class="n">Resources</span><span class="o">.</span><span class="n">REST</span>
<span class="lineno">2</span>     <span class="vi">@entity</span> <span class="s1">&#39;post&#39;</span>
</code></pre></div>


Директива `@entity 'model_name'` обязательна, она позволит построить путь к стандартному REST-ресурсу Rails: `localhost:3000/posts.json`

<div class='info '><p>Построить путь к нестандартному Rails-ресурсу позволит директива <code>@source &#39;/funny_cats/latest_posts.json&#39;</code></p>
</div>

<p>Чтобы воспользоваться базовыми возможностями Joosy-ресурса, создадим базовый класс странички и ее шаблон, чтобы посмотреть записи блога. В консоли воспользуемся генератором:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">rails g joosy:page posts/index blog
</code></pre></div>
<p>В класс странички <code>app/assets/javascripts/pages/posts/index.coffee</code> добавим получение записей блога:</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">@fetch (complete) -&gt;
  Post.all (error, data) =&gt;
    @data.posts = data
    complete()
</code></pre></div>
<p>Весь класс страницы должен выглядеть так:</p>

<h5>app/assets/javascripts/pages/posts/index.coffee</h5>

<div class="highlight"><pre><code class="ruby"><span class="lineno"> 1</span>     <span class="no">Joosy</span><span class="o">.</span><span class="n">namespace</span> <span class="s1">&#39;Posts&#39;</span><span class="p">,</span> <span class="o">-&gt;</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span>       <span class="k">class</span> <span class="vi">@IndexPage</span> <span class="n">extends</span> <span class="no">ApplicationPage</span>
<span class="lineno"> 4</span>         <span class="vi">@layout</span> <span class="no">ApplicationLayout</span>
<span class="lineno"> 5</span>         <span class="vi">@view</span> <span class="s1">&#39;index&#39;</span>
<span class="lineno"> 6</span> 
<span class="lineno"> 7</span>         <span class="vi">@fetch</span> <span class="p">(</span><span class="n">complete</span><span class="p">)</span> <span class="o">-&gt;</span>
<span class="lineno"> 8</span>           <span class="no">Post</span><span class="o">.</span><span class="n">all</span> <span class="p">(</span><span class="n">error</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="o">=&gt;</span>
<span class="lineno"> 9</span>             <span class="vi">@data</span><span class="o">.</span><span class="n">posts</span> <span class="o">=</span> <span class="n">data</span>
<span class="lineno">10</span>             <span class="n">complete</span><span class="p">()</span>
</code></pre></div>

<p>Оживим страничку списком записей блога: <code>app/assets/javascripts/blog/templates/pages/posts/index.jst.hamlc</code></p>

<h5>app/assets/javascripts/blog/templates/pages/posts/index.jst.hamlc</h5>

<div class="highlight"><pre><code class="ruby"><span class="lineno"> 1</span>     <span class="o">-</span> <span class="vi">@posts</span><span class="o">.</span><span class="n">each</span> <span class="p">(</span><span class="n">post</span><span class="p">)</span> <span class="o">=&gt;</span>
<span class="lineno"> 2</span>       <span class="o">%</span><span class="n">h3</span>
<span class="lineno"> 3</span>         <span class="ss">Title</span><span class="p">:</span>
<span class="lineno"> 4</span>         <span class="o">%</span><span class="n">a</span><span class="p">{</span><span class="ss">:href</span> <span class="o">=&gt;</span> <span class="vi">@postPath</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="n">post</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))}</span>
<span class="lineno"> 5</span>           <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">get</span> <span class="s1">&#39;title&#39;</span>
<span class="lineno"> 6</span>       <span class="o">%</span><span class="n">span</span>
<span class="lineno"> 7</span>         <span class="o">.</span><span class="n">some</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">get</span> <span class="s1">&#39;body&#39;</span>
<span class="lineno"> 8</span>       <span class="o">%</span><span class="n">span</span>
<span class="lineno"> 9</span>         <span class="no">Comments</span> <span class="ss">count</span><span class="p">:</span>
<span class="lineno">10</span>         <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">get</span> <span class="s1">&#39;comments_count&#39;</span>
</code></pre></div>

<p>Добавим роуты в <code>app/assets/javascripts/blog/routes.coffee</code>, чтобы добраться до страницы:</p>

<h5>app/assets/javascripts/blog/routes.coffee</h5>

<div class="highlight"><pre><code class="ruby"><span class="lineno">1</span>     <span class="no">Joosy</span><span class="o">.</span><span class="n">Router</span><span class="o">.</span><span class="n">draw</span> <span class="o">-&gt;</span>
<span class="lineno">2</span>       <span class="vi">@root</span> <span class="ss">to</span><span class="p">:</span> <span class="no">Welcome</span><span class="o">.</span><span class="n">IndexPage</span>
<span class="lineno">3</span>       <span class="vi">@match</span> <span class="s1">&#39;/posts&#39;</span><span class="p">,</span>  <span class="ss">to</span><span class="p">:</span> <span class="no">Posts</span><span class="o">.</span><span class="n">IndexPage</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="s1">&#39;posts&#39;</span>
<span class="lineno">4</span>       <span class="vi">@match</span> <span class="s1">&#39;/posts/:id&#39;</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="no">Posts</span><span class="o">.</span><span class="n">ShowPage</span><span class="p">,</span> <span class="ss">as</span><span class="p">:</span> <span class="s1">&#39;post&#39;</span>
</code></pre></div>

<p>И убедимся что все работает, откроем страницу: <code>localhost:3000/blog/posts</code></p>

      </div>
    </article>
  </section>
</div>

    <footer class='container'>
      <div class='pull-left'>
        <p>
          <strong>
            Copyright 2012-2013,
            <a href='http://staal.io'>
              Boris Staal
            </a>
          </strong>
          <br>
          <small>
            <span>
              Hosted at
            </span><a href='http://pages.github.com'>Github Pages</a>,
            <span>
              generated with
            </span><a href='http://jekyllrb.com'>Jekyll</a></small>
        </p>
      </div>
      <div class='pull-right'>
        <p>
          Want to improve something on this site?
          <br><a href='https://github.com/joosy/guides'>Pull requests</a><span>
            are very welcome!
          </span>
        </p>
      </div>
    </footer>
    <a href='https://github.com/joosy/joosy' id='github'>
      <img alt='Fork me on GitHub' src='https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png' style='position: absolute; top: 0; right: 0; border: 0;'>
    </a>
    <script>
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '4fb67f54f5a1f56550000016');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>
